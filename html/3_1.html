<!doctype html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="file/c.css" media="all"><title>URL分发 与 Mako模板</title></head><body>
<a id="bar" href="index.html">返回目录</a>
<div id="header">
<h1>URL分发 与 Mako模板</h1>
</div>

<div id="preamble">
<p>用户注册是大部分网站最基本的功能。</p>
<p>这里，用户注册分两步，四个页面。</p>
<p>第一步，</p>
<p>    1.填写邮箱，提交注册申请</p>
<p>    2.发出邮件，提示用户接收</p>
<p>第二步，</p>
<p>    1.用户激活，填写详细信息</p>
<p>    2.激活成功，跳转欢迎页面</p>
<p>每一步又对应一个URL,设计URL也有很多讲究。用一句话概述就是：简短好记，避免更变（有兴趣可以读读 Cool URI don't change <a target="_blank" href="http://www.w3.org/Provider/Style/URI">http://www.w3.org/Provider/Style/URI</a>）。</p>
<p>这里，我们使用 /auth/apply 和 /auth/reg 。</p>
<p>在 mysite/ctrl 目录下 新建 auth.py ， 内容如下</p>
<div class="content"><pre>
#coding:utf-8
from mypy.route_render import route_render_func

@route_render_func
def apply():
    pass

@route_render_func
def reg():
    pass
</pre></div>
<p>同时在 init_url.py 中添加一行</p>
<div class="content"><pre>
import auth
</pre></div>
<p>在 myfile/css/my.css 的结尾加上</p>
<div class="content"><pre>
.FormPage{margin:40px auto 0;width:335px;}
.BForm select{font-size:16px;margin-left:-6px;}
.BForm span{display:block;margin-top:5px;font-size:14px;color:#666;text-align:left;margin-left:38px}
.BForm p label{margin-right:10px}
.BForm p input{width:286px}
.BForm p{margin-bottom:20px;font-size:14px}
.BForm .Err,.Err{padding-bottom:2px;font-size:12px;margin-top:0;color:#d30}
.Err{display:block}
.Warn{color:#d30;}
.Ok{color:#090;}
.HideErr .Err{display:none}
</pre></div>
<p>在 myfile/js 文件夹中新建 reg.js ,内容如下</p>
<div class="content"><pre>
$(function(){
$(".FormPage input:first").focus()
})
</pre></div>
<p>运行 myfile 下的 merge.py 。</p>
<p>在 mysite/htm 下新建目录 auth，然后新建模板内容如下</p>
<div class="content"><pre>
&lt;%inherit file="/htmbase/simple_base.htm" /&gt;
&lt;%!
from myfile import js,css
%&gt;

&lt;%def name="html_head()" filter="trim"&gt;
&lt;script src="${js.reg}"&gt;&lt;/script&gt;
&lt;/%def&gt;

&lt;%def name="html_body()" filter="trim"&gt;
&lt;form class="HideErr BForm FormPage" method="POST" onsubmit="return submit_form()"&gt;
&lt;p align="center" style="padding-bottom:20px"&gt;许多故事,从这里开始...&lt;/p&gt;

&lt;p&gt;
&lt;span class="Err" id="err_email"&gt;&lt;/span&gt;
&lt;label&gt;邮箱&lt;/label&gt;&lt;input autocomplete="off" type="text" value="" class="text" name="email" id="email"/&gt;
&lt;span&gt;输入Email邮箱,接收确认邮件以完成注册。 &lt;/span&gt;
&lt;/p&gt;

&lt;p&gt;
&lt;span class="Err" id="err_name"&gt;&lt;/span&gt;
&lt;label&gt;网名&lt;/label&gt;&lt;input autocomplete="off" type="text" value="" class="text" name="name" id="name"/&gt;
&lt;span&gt;中英文皆可,不要超过8个汉字。 &lt;/span&gt;
&lt;/p&gt;

&lt;p align="center"&gt;&lt;button style="font-size:16px;padding:3px 6px;" type="submit"&gt;注册&lt;/button&gt;&lt;/p&gt;
&lt;/form&gt;
&lt;/%def&gt;
</pre></div>
<div class="imageblock">
<div class="content">
<img alt="KanRS申请注册" src="img/kanrs_apply.png"/>
</div>

<div class="image-title">图:KanRS申请注册</div>
</div>
<p>然后介绍模板 mako ， 等等</p>
<p>介绍route 分发</p>

<div class="dirnav">
<a href="3_0.html">上一节</a>
<a href="index.html">返回目录</a>
<a href="3_2.html">下一节</a>
</div>

</div>

<script type="text/javascript" src="file/c.js"></script>
<div id="footer">
  <p class="copyright">
    Copyright 2009,
    张沈鹏,
	董诣,
    陈寅,
	<span class="amp">&amp;</span>
    敬宓    
  </p>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-10347470-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>





